tags:
  - name: Authentication
    description: Endpoints for authentication and OAuth

paths:

  /auth/login:
    post:
      summary: Login user and get tokens
      tags: [Authentication]
      description: Authenticate user using email and password to receive access and refresh tokens.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                  example: "user@example.com"
                password:
                  type: string
                  example: "P@ssw0rd123"
      responses:
        200:
          description: Login successful
          content:
            application/json:
              example:
                result:
                  data:
                    accessToken: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                    refreshToken: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                    user:
                      id: "a1b2c3d4-e5f6-7890-a1b2-c3d4e5f67890"
                      email: "user@example.com"
                      fullname: "User Name"
                      roles: ["user"]
                      source: "email"
                      is_verified: true
                code: 200
                message: "OK - Request successful"
                description: "Login successful."
        401:
          description: Invalid credentials
          content:
            application/json:
              example:
                result: null
                code: 401
                message: "Invalid Credentials - Wrong username/password"
                description: "Email or password is incorrect."
        403:
          description: Wrong source
          content:
            application/json:
              example:
                result: null
                code: 403
                message: "Access Denied - Permission denied"
                description: "This account was registered via Google. Please use Google login."

  /auth/logout:
    post:
      summary: Logout user
      tags: [Authentication]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [refreshToken]
              properties:
                refreshToken:
                  type: string
                  example: "your_refresh_token_here"
      responses:
        200:
          description: Logout successful
          content:
            application/json:
              example:
                result:
                  data: null
                code: 200
                message: "OK - Request successful"
                description: "Logout successful."
        400:
          description: Missing token
          content:
            application/json:
              example:
                result: null
                code: 400
                message: "Missing Token - Authorization required"
                description: "Refresh token is required."

  /auth/refresh:
    post:
      summary: Refresh access token
      tags: [Authentication]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [refreshToken]
              properties:
                refreshToken:
                  type: string
                  example: "your_refresh_token_here"
      responses:
        200:
          description: Token refreshed successfully
          content:
            application/json:
              example:
                result:
                  data:
                    accessToken: "new.jwt.access.token"
                code: 200
                message: "OK - Request successful"
                description: "Access token successfully refreshed."
        401:
          description: Invalid or expired refresh token
          content:
            application/json:
              example:
                result: null
                code: 401
                message: "Invalid Token - Token is invalid or expired"
                description: "Invalid refresh token: jwt expired"

  /auth/google:
    get:
      summary: Redirect to Google login (open in browser)
      tags: [Authentication]
      responses:
        302:
          description: Redirects to Google login page.

  /auth/google/callback:
    get:
      summary: Google OAuth callback
      tags: [Authentication]
      responses:
        200:
          description: Successful Google login
          content:
            application/json:
              example:
                result:
                  data:
                    accessToken: "jwt.token.value"
                    refreshToken: "jwt.refresh.token"
                    user:
                      id: "uuid"
                      email: "user@example.com"
                      fullname: "Google User"
                      roles: ["user"]
                code: 200
                message: "OK - Request successful"
                description: "Login via Google successful."
        409:
          description: Conflict (Email already registered via another source)
          content:
            application/json:
              example:
                result: null
                code: 409
                message: "Conflict - Email already registered"
                description: "This email is already registered via 'email'. Please log in using that method."

  /auth/github:
    get:
      summary: Redirect to GitHub login (open in browser)
      tags: [Authentication]
      responses:
        302:
          description: Redirects to GitHub login page.

  /auth/github/callback:
    get:
      summary: GitHub OAuth callback
      tags: [Authentication]
      responses:
        200:
          description: Successful GitHub login
          content:
            application/json:
              example:
                result:
                  data:
                    accessToken: "jwt.token.value"
                    refreshToken: "jwt.refresh.token"
                    user:
                      id: "uuid"
                      email: "user@example.com"
                      fullname: "GitHub User"
                      roles: ["user"]
                code: 200
                message: "OK - Request successful"
                description: "Login via GitHub successful."
        409:
          description: Conflict (Email already registered via another source)
          content:
            application/json:
              example:
                result: null
                code: 409
                message: "Conflict - Email already registered"
                description: "This email is already registered via 'email'. Please log in using that method."